<!DOCTYPE html>
<html>
    <head>
        <title>Staff Account View Records</title>
        <link rel="stylesheet" type="text/css" href="css/style.css">
    </head>
    <style>
        .Staff-Page-tile {

            overflow-y: scroll; 
        }
        .Staff-Page-tile {
            text-align: center;
            background-color: #fff;
            padding: 10px;
            border-radius: 10px;
            width: 60%;
            height: 80%;
            color: #fff;
            position: absolute;
            top: 35%;
            left: 50%;
            transform: translate(-50%, -25%);
        }
        .recordWrapper{
            border: 2px solid rgb(0,64,128);
            display: flex;
            margin-bottom:20px;
        }
        .recordID{
            background-color: rgb(0,64,128);
            width:fit-content;
            padding: 10px 15px 0 15px;
            font-size: 20px;
            color: white;
        }

    </style>
    <body>
        <div class="header">
            <div class="logo">
                <h1>B.C Health & Wellness</h1>
            </div>
        </div>
        
        <div class="nav">
            <a href="homePage.html">HOME</a>
            <a onclick="redirect()">ACCOUNT</a>
        </div>

        <!-- Using the Same format that was used in the Staff Account Details page for this one -->
        <div class="Staff-Page-tile" style="text-align:left">
            <h1>View Records</h1>
            <div class="nav" style="margin:10px 20px 0px 20px; width:initial">
                <a onclick="showVisitHistory()">Visit History</a>
                <a onclick="showPrescriptions()">Prescriptions</a>
                <a onclick="showLabExams()">Lab Exams</a>
                <a onclick="showLabExamResults()">Lab Exam Results</a>
            </div>
            <ul id="recordList" style="padding:20px"></ul>
        </div>
        <script>
            function redirect(){
                let accountType = sessionStorage.getItem("accountType");
            
                if (accountType == "p"){
                    window.location.assign("accountDetailsPatient.html");
                } else if (accountType == "s") {
                    window.location.assign("accountDetailsStaff.html");
                } else if (accountType == "d"){
                    window.location.assign("accountDetailsDoctor.html");
                }
                else {
                    alert("Not logged in!")
                }
            }
            
            function showVisitHistory(){
                if(sessionStorage.getItem("accountType") == "p"){
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                    .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''

                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.visitDate){
                                content.innerHTML = `   <b>Doctor:</b> ${record.prescribingDoctor}<br>
                                                        <b>Visit Date:</b> ${record.visitDate ? record.visitDate: 'N/A'}<br>` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else if (sessionStorage.getItem("accountType") == "d") {
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                    .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''

                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.visitDate){
                                content.innerHTML = `   <b>Patient:</b> ${record.relatedPatient}<br>
                                                        <b>Visit Date:</b> ${record.visitDate ? record.visitDate: 'N/A'}<br>` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else if (sessionStorage.getItem("accountType") == "s") {
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                    .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''

                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.visitDate){
                                content.innerHTML = `   <b>Doctor:</b> ${record.prescribingDoctor}<br>
                                                        <b>Patient:</b> ${record.relatedPatient}<br>
                                                        <b>Visit Date:</b> ${record.visitDate ? record.visitDate: 'N/A'}<br>` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else {
                    alert("Log in to view records!")
                }
            }

            function showPrescriptions(){
                if(sessionStorage.getItem("accountType") == "p"){
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                    .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''

                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.medicineName){
                                content.innerHTML = `   <b>Prescribed during VisitID:</b> ${record.prescribedDuring}<br>
                                                        <b>Date Prescribed:</b> ${record.datePrescribed}<br>
                                                        <b>Prescribing Doctor:</b> ${record.prescribingDoctor}<br>
                                                        <b>Medicine Name:</b> ${record.medicineName}<br>
                                                        <b>Medicine Quantity:</b> ${record.medicineQuantity ? record.medicineQuantity : 'N/A'}<br>
                                                        <b>Medicine Dose:</b> ${record.medicineDose ? record.medicineDose : 'N/A'}<br>
                                                        <b>Refillable:</b> ${record.refillable}<br>` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else if (sessionStorage.getItem("accountType") == "d") {
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                    .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''

                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.medicineName){
                                content.innerHTML = `   <b>Prescribed during VisitID:</b> ${record.prescribedDuring}<br>
                                                        <b>Date Prescribed:</b> ${record.datePrescribed}<br>
                                                        <b>Patient:</b> ${record.relatedPatient}<br>
                                                        <b>Medicine Name:</b> ${record.medicineName}<br>
                                                        <b>Medicine Quantity:</b> ${record.medicineQuantity ? record.medicineQuantity : 'N/A'}<br>
                                                        <b>Medicine Dose:</b> ${record.medicineDose ? record.medicineDose : 'N/A'}<br>
                                                        <b>Refillable:</b> ${record.refillable}<br>` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else if (sessionStorage.getItem("accountType") == "s") {
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                    .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''

                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.medicineName){
                                content.innerHTML = `   <b>Prescribed during VisitID:</b> ${record.prescribedDuring}<br>
                                                        <b>Date Prescribed:</b> ${record.datePrescribed}<br>
                                                        <b>Prescribing Doctor:</b> ${record.prescribingDoctor}<br>
                                                        <b>Patient:</b> ${record.relatedPatient}<br>
                                                        <b>Medicine Name:</b> ${record.medicineName}<br>
                                                        <b>Medicine Quantity:</b> ${record.medicineQuantity ? record.medicineQuantity : 'N/A'}<br>
                                                        <b>Medicine Dose:</b> ${record.medicineDose ? record.medicineDose : 'N/A'}<br>
                                                        <b>Refillable:</b> ${record.refillable}<br>` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else {
                    alert("Log in to view records!")
                }
            }

            function showLabExams(){
                if(sessionStorage.getItem("accountType") == "p"){
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                     .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''
                        
                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.examDate){
                                content.innerHTML = `   <b>Exam requested during VisitID:</b> ${record.prescribedDuring}<br>
                                                        <b>Lab Exam Scheduled Date:</b> ${record.examDate}<br>
                                                        <b>Prescribing Dr:</b> ${record.prescribingDoctor}<br>
                                                        <b>Test for:</b> ${record.examItem ? record.examItem : 'N/A'}<br>` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else if (sessionStorage.getItem("accountType") == "d") {
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                     .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''
                        
                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.examDate){
                                content.innerHTML = `   <b>Exam requested during VisitID:</b> ${record.prescribedDuring}<br>
                                                        <b>Lab Exam Scheduled Date:</b> ${record.examDate}<br>
                                                        <b>Patient:</b> ${record.relatedPatient}<br>
                                                        <b>Test for:</b> ${record.examItem ? record.examItem : 'N/A'}<br>` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else if (sessionStorage.getItem("accountType") == "s") {
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                     .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''
                        
                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.examDate){
                                content.innerHTML = `   <b>Exam requested during VisitID:</b> ${record.prescribedDuring}<br>
                                                        <b>Lab Exam Scheduled Date:</b> ${record.examDate}<br>
                                                        <b>Prescribing Dr:</b> ${record.prescribingDoctor}<br>
                                                        <b>Patient:</b> ${record.relatedPatient}<br>
                                                        <b>Test for:</b> ${record.examItem ? record.examItem : 'N/A'}<br>` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else {
                    alert("Log in to view records!")
                }
            }

            function showLabExamResults(){
                if(sessionStorage.getItem("accountType") == "p"){
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                     .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''
                        
                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.relatedExam){
                                content.innerHTML = `   <b>Results for LabExamID:</b> ${record.relatedExam}<br>
                                                        <b>Prescribing Doctor:</b> ${record.prescribingDoctor}<br>
                                                        <b>Normal Range:</b> ${record.normalLowerBound && record.normalUpperBound ? `${record.normalLowerBound}-${record.normalUpperBound}` : 'N/A'}<br>
                                                        <b>Result:</b> ${record.result ? record.result : 'N/A'}<br>
                                                        <b>Normal Result:</b> ${record.normalResult ? 'Yes' : 'No'}` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else if (sessionStorage.getItem("accountType") == "d") {
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                     .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''
                        
                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.relatedExam){
                                content.innerHTML = `   <b>Results for LabExamID:</b> ${record.relatedExam}<br>
                                                        <b>Patient:</b> ${record.relatedPatient}<br>
                                                        <b>Normal Range:</b> ${record.normalLowerBound && record.normalUpperBound ? `${record.normalLowerBound}-${record.normalUpperBound}` : 'N/A'}<br>
                                                        <b>Result:</b> ${record.result ? record.result : 'N/A'}<br>
                                                        <b>Normal Result:</b> ${record.normalResult ? 'Yes' : 'No'}` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else if (sessionStorage.getItem("accountType") == "s") {
                    fetch('http://localhost:8080/getRecords?email=' + sessionStorage.getItem("email") + '&password=' + sessionStorage.getItem("password") + '&recordType=all') 
                    .then(response => response.json())
                     .then(records => {
                        const recordList = document.getElementById('recordList')
                        //remove all child elements upon a button click
                        recordList.innerHTML =''
                        
                        // Create list item for each record
                        records.forEach(record => {
                            const listItem = document.createElement('div');
                            listItem.classList.add("recordWrapper")

                            const ID = document.createElement("div")
                            ID.classList.add("recordID")
                            ID.innerHTML = `Record ID:<br><b>${record.recordID}<b>`
                            listItem.appendChild(ID)

                            const content = document.createElement("p")
                            content.style.textAlign = "left"
                            content.style.fontSize = "18px"
                            content.style.padding = "10px"
                            listItem.appendChild(content)
                            
                            if(record.relatedExam){
                                content.innerHTML = `   <b>Results for LabExamID:</b> ${record.relatedExam}<br>
                                                        <b>Prescribing Doctor:</b> ${record.prescribingDoctor}<br>
                                                        <b>Patient:</b> ${record.relatedPatient}<br>
                                                        <b>Normal Range:</b> ${record.normalLowerBound && record.normalUpperBound ? `${record.normalLowerBound}-${record.normalUpperBound}` : 'N/A'}<br>
                                                        <b>Result:</b> ${record.result ? record.result : 'N/A'}<br>
                                                        <b>Normal Result:</b> ${record.normalResult ? 'Yes' : 'No'}` 
                                recordList.appendChild(listItem)
                            }
                        })
                    })
                    .catch(error => console.error(error));
                } else {
                    alert("Log in to view records!")
                }
            }
          </script>
          
    </body>
</html>
